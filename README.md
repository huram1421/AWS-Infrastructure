# AWS-Infrastructure
Architected and deployed a Golang RESTful micro-service cloud-based infrastructure using Terraform and Ansible IaC tools with AWS cloud provider.



<body><article id="c633a81e-a6e6-46b2-b6d7-c5291f19dd7b" class="page sans"><header><h1 class="page-title">readme</h1></header><div class="page-body"><h3 id="baa8fc7f-4c1d-422d-9901-0a1ebe250306" class=""><details open=""><summary>My Information</summary></details></h3><div class="indented"><h3 id="45a09ab2-5acd-457e-b3cf-807fb594f274" class="">Hussain Alramadan</h3><h3 id="baa1e817-9fe6-4275-b97f-9eba02a13ffd" class="">201853540</h3></div><p id="bbe22875-f5e0-4be2-90ba-1f3befa20c82" class="">
</p><h3 id="c89bfa8c-cf7c-4d67-aa6a-b4123c9734d7" class=""><details open=""><summary>COE Dept. Cloud Computing CX Project</summary></details></h3><div class="indented"><h3 id="31b6af32-2c15-4e56-a767-836894ad266c" class="">To Professor: Yahya Osais</h3><p id="d21d20f3-7cb6-493f-b53d-4ab126b91293" class="">
</p></div><h3 id="de9ff8a0-f0c2-49b7-8afb-4c683f5f87a3" class=""><details open=""><summary>Watch This Video for Easier Understanding (9 min)</summary></details></h3><div class="indented"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7cdcd3df-3208-4d84-8de8-6aba43bd7560"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Run it at 1.5x speed :)<p id="247569cf-457e-4e7f-ace6-fe16de4326c6" class=""><a href="https://youtu.be/6PUj8q7s2Mw">https://youtu.be/6PUj8q7s2Mw</a></p></div></figure></div><p id="ccdd4e1d-e1c1-46c4-b95f-3d2197b08d69" class="">
</p><h3 id="1c261be7-3a6a-4f18-8949-9eb18f4100d0" class=""><details open=""><summary>Workload Samples</summary></details></h3><div class="indented"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="aa088fb2-ab15-4b08-aaba-0fbf97ede79c"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%"><strong>For Driver Lambda</strong><pre id="6faafd13-62c1-4c76-8f3f-13a35e78f118" class="code"><code>{
	"ID": 1,
    "Name": "Hussain",
    "Kind": "D",
    "Src": "DMM",
    "Dest": "RYD"
}</code></pre></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="96893455-ccf3-4f01-ba04-6a640131cf0f"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">For Rider Lambda<pre id="0340ba42-3db7-4717-87f3-224103738c29" class="code"><code>{
	"ID": 2,
    "Name": "Abdullah",
    "Kind": "R",
    "Src": "DMM",
    "Dest": "RYD"
}</code></pre></div></figure></div><p id="e12b54a9-e0d0-4b8b-b68b-c67a8abc725a" class="">
</p><h3 id="1caf8fc9-7061-425b-8246-03f2838b1c00" class=""><details open=""><summary>Terraform Setup</summary></details></h3><div class="indented"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="0a76e251-1962-4696-8377-f9e2fec90883"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Put AWS <mark class="highlight-teal">credential</mark> in <code><a href="http://variables.tf">variables.tf</a></code> of the root <code>main.tf</code></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="ee9c4c2e-32de-4836-9d95-940b6038fabf"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Run <code>terraform init</code> and <code>terraform apply</code> in the <mark class="highlight-red"><strong>AWS Project</strong></mark> directory.<hr id="572eb331-8b2e-4f37-8492-85fced93c574"><p id="86be610f-d499-4cf7-a52a-2bbeb108cda9" class=""><mark class="highlight-red"><strong>AWS Project</strong></mark> contains the following:</p><ul id="10b7a329-59b6-4fb1-8fa9-54078e8161be" class="bulleted-list"><li style="list-style-type:disc">Terraform files</li></ul><ul id="42038232-fe6a-46ab-9a85-6184e94dc87b" class="bulleted-list"><li style="list-style-type:disc">2 Ansible Scripts<ul id="3a9ef4db-d002-460a-98ad-fd770dd3e3b2" class="bulleted-list"><li style="list-style-type:circle">go_setup.yml</li></ul><ul id="dabfc9d1-320f-459d-bd10-6bd79a94549f" class="bulleted-list"><li style="list-style-type:circle">hosts.yml</li></ul></li></ul><ul id="d683b26e-4063-44a3-b9e0-e7d5f6511135" class="bulleted-list"><li style="list-style-type:disc">4 GoLang Scripts<ul id="c21e199b-1220-4bf8-8991-c25715eb419b" class="bulleted-list"><li style="list-style-type:circle">api.go</li></ul><ul id="a5ee927a-98cf-4efb-ac3a-9ad0baca62b0" class="bulleted-list"><li style="list-style-type:circle">deleteTableItem.go</li></ul><ul id="e565a151-6992-4734-a4e8-5d1813b788cf" class="bulleted-list"><li style="list-style-type:circle">getTableItem.go</li></ul><ul id="b23ebae9-dca5-447a-8432-a0d8398449e9" class="bulleted-list"><li style="list-style-type:circle">logic.go</li></ul></li></ul><hr id="c1ece803-2f6b-41e3-8c78-b46793377746"><blockquote id="394514b2-411d-41b8-a375-c84499968cd6" class="">Note that Lambda function Python Scripts are inside the Lambda terraform file.</blockquote></div></figure><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="1822d121-c38d-4db6-80de-95f1a58fdafa"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">After <code>terraform apply</code> three outputs will generated<ul id="a347aaa6-e40c-4515-a709-6ed882d7d4f9" class="bulleted-list"><li style="list-style-type:disc">Public EC2 ip address</li></ul><ul id="d3d9fa4f-e78e-45fd-9115-c2d986bff4fe" class="bulleted-list"><li style="list-style-type:disc">AWS API Link without paths to lambda functions</li></ul><ul id="1167e814-4176-4d4a-9a05-af586daa993d" class="bulleted-list"><li style="list-style-type:disc">Private and public EC2 <code>keypair</code><ul id="9cb4c1cb-8ab0-417f-889a-d40067342887" class="bulleted-list"><li style="list-style-type:circle">this will be generated and ready to be used in <mark class="highlight-red"><strong>AWS Project</strong></mark> file for SSH connection to both public and private EC2 instances.</li></ul></li></ul></div></figure></div><p id="44123faf-788a-4903-b060-722c6ec4a743" class="">
</p><h3 id="fe504287-4cb6-47ba-930e-bf8de18042aa" class=""><details open=""><summary>Everything is Automated Except the Following:</summary></details></h3><div class="indented"><p id="20ee9454-2adc-42df-95fb-17e435fb3a73" class="">
</p><blockquote id="9466df1b-4b97-4031-9d97-5d5865d4c3a2" class=""><span style="border-bottom:0.05em solid"><mark class="highlight-red">Follow them sequentially</mark></span></blockquote><p id="5416dbcf-c910-406a-9153-37e32b932673" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="4a5076c2-ef1a-4655-a67f-9dce80112144"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Execute the following commands in the public EC2<pre id="d3402675-3eeb-4b2a-934c-8ec53e0e6de7" class="code"><code>chmod 400 ec2_key_pair
ssh-agent bash
cp ec2_key_pair ~/.ssh/
ssh-add ~/.ssh/ec2_key_pair
export ANSIBLE_HOST_KEY_CHECKING=False</code></pre></div></figure><p id="425c0b11-ae7c-4bc7-8ef6-09a399ccca60" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="568618ce-1467-42d7-a2a4-bf404aa98155"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Execute <code>go_setup.yml</code> script in master host (i.e., public EC2) to be executed in the target hosts in <code>hosts.yml</code> script (i.e., private EC2).<pre id="34f82193-c6f5-46dc-b6ca-5c82f1436e92" class="code"><code>ansible-playbook -i hosts.yml go_setup.yml</code></pre></div></figure><p id="8f150167-7abe-444f-b07f-49bd9ddcb5bf" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="2a7af0fd-f991-4ce4-8817-665dc6d53947"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">SSH to private EC2 (its IP is fixed to be 10.0.1.50)<pre id="0ae37bb9-08c3-4271-a08e-431702f84f4c" class="code"><code>ssh -i ec2_key_pair ec2-user@10.0.1.50</code></pre></div></figure><p id="98911c21-fd51-486d-9ee8-b68913aaa3b4" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a79b41ae-fe28-45a1-8db2-28595f8c4ed0"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Configure AWS SDK Credentials in the private EC2 to give the ability to reach the dynamoDB<pre id="7d68b552-c021-4cd2-b666-f2804c149eac" class="code"><code>aws configure

&lt;access_key&gt;
&lt;private_key&gt;
&lt;region&gt;</code></pre></div></figure><p id="5b154e20-265a-485e-a1e4-98a93084b70a" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a210e53f-0034-42ac-aa34-67a3ab8a9c43"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Execute Go scripts in the private EC2<pre id="348bec3f-dc47-463a-839d-af5b65c64ccc" class="code"><code>
go run logic.go &amp;
go run putTableItem.go &amp;
go run getTableItem.go &amp;
go run deleteTableItem.go &amp;
// &amp; is used to execute the srcipt in the background to be able to run multiple scripts</code></pre><hr id="53a2a277-fff6-4297-96e3-5bbc3269df90"><blockquote id="18ca6597-02b8-4b48-af0f-51670cebe2a6" class="">Before those scripts get started executing by the EC2, GoLang runtime will download packages for data dependencies.<p id="8e160c40-83f0-433d-8f7a-6ec7dd14a04b" class="">
</p><p id="fe0e17f1-5f1c-41ff-be7f-18f0b65e1d4b" class="">Give the GoLang runtime some time to complete downloading.</p><p id="bb634b8a-9d69-4dd2-9879-76b636b4f730" class="">
</p><p id="83e8ba91-9ae3-468f-8565-6fdd89228de5" class="">You can check by seeing the .go script name when writing this command <code>ps</code></p><p id="174f4f74-d060-4381-97fa-0bd25e7de8e7" class="">to show the currently running processes in the EC2.</p></blockquote></div></figure><p id="fa073120-28c8-4591-b6d7-86e9b6f05426" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7a825bdc-4756-4d1e-870f-ad51aacd2837"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Exist from private EC2 and execute <code>api.go</code> in public EC2<pre id="1f250957-4d99-43e2-a200-58310b0e232e" class="code"><code>exit
go run api.go &amp;</code></pre></div></figure><p id="1cebbd74-ac91-46d2-9505-87c1a7bebf14" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="9f379bf2-cc24-41de-95cb-130fa17fc35c"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Go to lambda functions in AWS console and add the Public IP to Python Code there for <mark class="highlight-red"><strong>all functions</strong></mark> (which are only two) as shown in this picture.<figure id="6d02a68e-8ebb-482b-a42b-d11fdb2549a4" class="image"><a href="readme%20c633a81ea6e646b2b6d7c5291f19dd7b/Screen_Shot_2022-12-18_at_9.32.17_PM.png"><img style="width:1214px" src="readme%20c633a81ea6e646b2b6d7c5291f19dd7b/Screen_Shot_2022-12-18_at_9.32.17_PM.png"></a></figure></div></figure><p id="d6f2fd02-f728-4a9f-a7a2-ce6a1faf9fc0" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7f2157c3-eb20-4957-af58-7a2631d95b43"><div style="font-size:1.5em"><span class="icon">ðŸ’¡</span></div><div style="width:100%">Get API link and add routes<p id="9d675cf0-40e9-467a-a14c-d33e63fde553" class=""><code>/lambda/DriverLambda</code></p><p id="8178488f-ba33-4ea6-a282-23b5f3583bd4" class=""><code>/lambda/RiderLambda</code></p></div></figure><p id="12b0ecbb-d630-4bbd-a620-eb9cb8dba940" class="">
</p></div><p id="3a212f55-aadd-448e-a293-fe9f709b94da" class="">
</p></div></article></body>

